# Руководство по использованию GitHub Actions для сборки APK

## Что такое GitHub Actions?

GitHub Actions - это платформа для автоматизации CI/CD (Continuous Integration/Continuous Deployment), которая позволяет автоматически собирать, тестировать и развертывать ваш код.

## Как запустить сборку APK

### Шаг 1: Загрузите код в GitHub

1. Создайте новый репозиторий на GitHub
2. Загрузите все файлы проекта в репозиторий
3. Убедитесь, что файл `.github/workflows/android-apk.yml` присутствует

### Шаг 2: Запустите workflow

1. Перейдите в ваш репозиторий на GitHub
2. Нажмите на вкладку **"Actions"** в верхнем меню
3. В левой панели выберите **"Build Android APK"**
4. Нажмите кнопку **"Run workflow"**
5. Выберите ветку (обычно `main` или `master`)
6. Нажмите **"Run workflow"**

### Шаг 3: Мониторинг сборки

1. После запуска вы увидите новый workflow run
2. Нажмите на него, чтобы посмотреть детали
3. Вы можете наблюдать за каждым шагом сборки в реальном времени
4. Если произойдет ошибка, вы увидите подробную информацию

### Шаг 4: Скачивание APK

1. После успешной сборки перейдите в раздел **"Artifacts"**
2. Нажмите на **"apk"** для скачивания
3. Распакуйте архив и найдите файл `.apk`

## Что делает workflow?

### 1. Checkout (Загрузка кода)
- Загружает код из вашего репозитория

### 2. Setup Java 17
- Устанавливает Java 17 для сборки Android приложений

### 3. Setup Python
- Устанавливает Python 3.11

### 4. Set up Android SDK
- Устанавливает Android SDK с API 33
- Устанавливает Android NDK 25.1.8937393
- Устанавливает build-tools 33.0.0

### 5. Accept Android SDK licenses
- Автоматически принимает лицензии Android SDK

### 6. Install additional Android tools
- Устанавливает platform-tools и build-tools

### 7. Install build tools
- Устанавливает Python зависимости:
  - buildozer
  - Cython
  - kivy

### 8. Build APK
- Собирает APK файл с помощью buildozer

### 9. Upload artifact
- Загружает APK файл как артефакт для скачивания

## Время сборки

- **Первая сборка**: 10-15 минут (загрузка Android SDK и NDK)
- **Последующие сборки**: 5-10 минут (используется кэш)

## Ограничения GitHub Actions

- **Бесплатный план**: 2000 минут в месяц
- **Публичные репозитории**: неограниченно
- **Приватные репозитории**: 2000 минут в месяц

## Устранение проблем

### Ошибка "Workflow not found"
- Убедитесь, что файл `.github/workflows/android-apk.yml` существует
- Проверьте синтаксис YAML файла

### Ошибка "Android SDK not found"
- Workflow автоматически устанавливает Android SDK
- Если ошибка повторяется, проверьте версию workflow

### Ошибка "Build failed"
- Проверьте логи сборки
- Убедитесь, что все файлы проекта загружены
- Проверьте конфигурацию `buildozer.spec`

### Ошибка "Artifact not found"
- APK создается только при успешной сборке
- Проверьте, что сборка завершилась без ошибок

## Автоматический запуск

По умолчанию workflow запускается только вручную. Чтобы настроить автоматический запуск:

1. Отредактируйте файл `.github/workflows/android-apk.yml`
2. Измените секцию `on:`:

```yaml
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:
```

Это запустит сборку при каждом push в ветку main.

## Мониторинг и уведомления

### Email уведомления
- GitHub автоматически отправляет email при завершении workflow
- Настройте уведомления в настройках GitHub

### Статус сборки
- Добавьте badge в README для отображения статуса сборки:

```markdown
![Build Status](https://github.com/username/repository/workflows/Build%20Android%20APK/badge.svg)
```

## Дополнительные возможности

### Сборка для разных версий Android
- Измените `api-level` в workflow
- Добавьте несколько jobs для разных версий

### Автоматическое развертывание
- Добавьте шаг для загрузки APK в Google Play
- Настройте автоматическое создание релизов

### Кэширование
- GitHub Actions автоматически кэширует Android SDK
- Это ускоряет последующие сборки

## Безопасность

### Секреты
- Не храните пароли и ключи в коде
- Используйте GitHub Secrets для конфиденциальных данных

### Разрешения
- Workflow имеет доступ только к коду репозитория
- Не может получить доступ к другим репозиториям

## Поддержка

Если у вас возникли проблемы с GitHub Actions:

1. Проверьте [документацию GitHub Actions](https://docs.github.com/en/actions)
2. Создайте Issue в репозитории
3. Обратитесь к сообществу GitHub

## Заключение

GitHub Actions предоставляет мощный и бесплатный способ автоматической сборки APK файлов. Это особенно полезно для:

- Автоматической сборки при изменениях кода
- Создания релизов
- Тестирования на разных платформах
- Сотрудничества в команде

Используйте этот инструмент для упрощения процесса разработки и развертывания ваших Android приложений!
